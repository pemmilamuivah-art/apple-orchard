<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Checkout — Apple Orchard</title>
  <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
  <header class="site-header">
    <div class="brand">
      <a href="index.html"><img class="logo" src="https://source.unsplash.com/collection/483251/80x80" alt="Apple Orchard logo"></a>
      <div>
        <h1>Apple Orchard</h1>
        <div class="muted">Farm-to-door fresh apples</div>
      </div>
    </div>
    <nav>
      <a href="products.html">Shop</a>
      <a href="about.html">About</a>
      <button id="view-cart-btn" class="cart-btn">Cart <span id="cart-count">0</span></button>
    </nav>
  </header>

  <main class="container">
    <h2>Checkout (Demo)</h2>
    <p class="muted">This is a simulated checkout for demonstration only — no real payment is taken.</p>

    <form id="checkout-form" class="container-card">
      <label>Full name
        <input name="name" required>
      </label>
      <label>Email
        <input name="email" type="email" required>
      </label>
      <label>Delivery address
        <textarea name="address" rows="3" required></textarea>
      </label>

      <div class="cart-preview" id="checkout-cart">
        <h4>Your items</h4>
        <div id="cart-items-checkout">No items</div>
        <div>Estimated total: <strong id="cart-total-checkout">₹0</strong></div>
      </div>

      <button class="btn checkout" type="submit">Place demo order</button>
    </form>
  </main>

  <footer class="site-footer">
    <div>© Apple Orchard — 123 Orchard Lane, Nashik, MH</div>
  </footer>

  <script src="assets/js/cart.js"></script>
  <script>
    document.getElementById('checkout-form').addEventListener('submit', function(e){
      e.preventDefault();
      if(Object.keys(window.demoCart.items||{}).length === 0){
        alert('Your cart is empty. Add something first.');
        window.location = 'products.html';
        return;
      }
      const name = this.name.value;
      alert('Thanks ' + name + '! Your demo order is placed. (No real payment collected.)');
      // clear cart
      window.demoCart.items = {};
      localStorage.removeItem('demoCart');
      window.location = 'index.html';
    });

    // populate checkout cart preview
    function renderCheckoutCart(){
      const itemsEl = document.getElementById('cart-items-checkout');
      const totalEl = document.getElementById('cart-total-checkout');
      const items = window.demoCart.items || {};
      const entries = Object.entries(items);
      if(entries.length===0){ itemsEl.textContent='No items'; totalEl.textContent='₹0'; return; }
      itemsEl.innerHTML = '';
      let total=0;
      entries.forEach(([id,q])=>{
        const priceMap = {gala:180,fuji:320,honeycrisp:450,granny:260};
        total += priceMap[id]*q;
        const div = document.createElement('div');
        div.textContent = q + '× ' + id;
        itemsEl.appendChild(div);
      });
      totalEl.textContent = '₹' + total.toLocaleString('en-IN');
    }
    // wait until cart script sets window.demoCart
    setTimeout(()=>{ if(window.demoCart) renderCheckoutCart(); }, 300);
  </script>
</body>
</html>
